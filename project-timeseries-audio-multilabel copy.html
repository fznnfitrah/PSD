
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Project Time Series Audio Dataset With MultiLabel &#8212; Project Science Data</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'project-timeseries-audio-multilabel copy';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Project Time Series Audio Dataset With MultiLabel" href="project-timeseries-audio-multilabel.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/me.jpg" class="logo__image only-light" alt="Project Science Data - Home"/>
    <script>document.write(`<img src="_static/me.jpg" class="logo__image only-dark" alt="Project Science Data - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to My Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="bisnis.html">Bussines Understanding</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="dataUnderstanding.html">Data Understanding</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="explorationData.html">Exploration Data</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="dataProcessing.html">Data Processing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="outlier_detection.html">Outliers Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="oversampling-data.html">Oversampling Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="ensembleLearning.html"><strong>Menghapus Dataset</strong></a></li>


<li class="toctree-l2"><a class="reference internal" href="bagging_method.html">Bagging Metode</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="project-timeseries-forecasting.html">Project TimeSeries Forecasting</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="project-timeseries-autoCorrelation.html">TimeSeries Forecasting with Feature Selection (Revisi)</a></li>
<li class="toctree-l2"><a class="reference internal" href="project-timeseries-audio.html">TimeSeries Analisis Audio Fitur Analitik</a></li>
<li class="toctree-l2"><a class="reference internal" href="project-timeseries-audio-multilabel.html">TimeSeries Analisis Audio Multi Label</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">TimeSeries Analisis Audio Multi Label (Revisi)</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fproject-timeseries-audio-multilabel copy.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/project-timeseries-audio-multilabel copy.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Project Time Series Audio Dataset With MultiLabel</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#membaca-dataset"><strong>Membaca Dataset</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ekstraksi-fitur"><strong>Ekstraksi Fitur</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seleksi-fitur-menggunakan-penilaian-score-dari-information-gain"><strong>Seleksi Fitur Menggunakan Penilaian Score dari Information Gain</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisasi-score-fitur-information-gain"><em>Visualisasi Score Fitur Information Gain</em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#show-score-valuation-with-reduce-feature"><em>Show Score Valuation with Reduce Feature</em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#memilih-jumlah-fitur-optimal"><em>Memilih Jumlah Fitur Optimal</em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#melakukan-normalisai"><em>Melakukan Normalisai</em></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling-dan-evaluasi-model"><strong>Modeling Dan Evaluasi Model</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#traning-model"><em>Traning Model</em></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simpan-model"><strong>Simpan Model</strong></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="project-time-series-audio-dataset-with-multilabel">
<h1><em><strong>Project Time Series Audio Dataset With MultiLabel</strong></em><a class="headerlink" href="#project-time-series-audio-dataset-with-multilabel" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">librosa</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>


<span class="kn">import</span><span class="w"> </span><span class="nn">tsfel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.impute</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.feature_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">mutual_info_classif</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">classification_report</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_scorer</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">mean_absolute_percentage_error</span>


<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.multioutput</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiOutputClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">LabelEncoder</span>
</pre></div>
</div>
</div>
</div>
<section id="membaca-dataset">
<h2><strong>Membaca Dataset</strong><a class="headerlink" href="#membaca-dataset" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -- Mengabaikan peringatan dari librosa terkait format non-wav --</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s1">&#39;librosa&#39;</span><span class="p">)</span>

<span class="n">METADATA_PATH</span> <span class="o">=</span> <span class="s2">&quot;dataset/metadata_anda.csv&quot;</span>
<span class="n">AUDIO_FOLDER_PATH</span> <span class="o">=</span> <span class="s2">&quot;dataset/dataset_wav/&quot;</span>
<span class="n">TARGET_SR</span> <span class="o">=</span> <span class="mi">16000</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Membaca file metadata dari </span><span class="si">{</span><span class="n">METADATA_PATH</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">df_metadata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">METADATA_PATH</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ERROR: File </span><span class="si">{</span><span class="n">METADATA_PATH</span><span class="si">}</span><span class="s2"> tidak ditemukan.&quot;</span><span class="p">)</span>
    <span class="k">raise</span>

<span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Memulai proses pembacaan </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_metadata</span><span class="p">)</span><span class="si">}</span><span class="s2"> file audio dari </span><span class="si">{</span><span class="n">AUDIO_FOLDER_PATH</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">df_metadata</span><span class="o">.</span><span class="n">iterrows</span><span class="p">(),</span> <span class="n">total</span><span class="o">=</span><span class="n">df_metadata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">AUDIO_FOLDER_PATH</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;file_name&#39;</span><span class="p">])</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="n">audio_signal</span><span class="p">,</span> <span class="n">sampling_rate</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">TARGET_SR</span><span class="p">)</span>
        
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;file_name&#39;</span><span class="p">],</span>
            <span class="s1">&#39;signal&#39;</span><span class="p">:</span> <span class="n">audio_signal</span><span class="p">,</span>
            <span class="s1">&#39;sampling_rate&#39;</span><span class="p">:</span> <span class="n">sampling_rate</span><span class="p">,</span>
            <span class="s1">&#39;label_buka&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;buka&#39;</span><span class="p">],</span>
            <span class="s1">&#39;label_tutup&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;tutup&#39;</span><span class="p">],</span>
            <span class="s1">&#39;label_fikri&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;fikri&#39;</span><span class="p">],</span>
            <span class="s1">&#39;label_fauzan&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;fauzan&#39;</span><span class="p">]</span>
        <span class="p">})</span>
        
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Warning: Gagal membaca file </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Proses pembacaan data selesai.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total file berhasil dibaca: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">data_list</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Contoh data pertama yang dimuat:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Membaca file metadata dari dataset/metadata_anda.csv...
Memulai proses pembacaan 400 file audio dari dataset/dataset_wav/...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|                                                                                                                                                                                                          | 0/400 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|▍                                                                                                                                                                                                 | 1/400 [00:02&lt;14:54,  2.24s/it]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  2%|███▍                                                                                                                                                                                              | 7/400 [00:02&lt;01:38,  4.00it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  3%|██████▎                                                                                                                                                                                          | 13/400 [00:02&lt;00:46,  8.36it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  5%|█████████▏                                                                                                                                                                                       | 19/400 [00:02&lt;00:28, 13.55it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  6%|████████████                                                                                                                                                                                     | 25/400 [00:02&lt;00:19, 19.07it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  8%|██████████████▉                                                                                                                                                                                  | 31/400 [00:02&lt;00:15, 24.57it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  9%|█████████████████▊                                                                                                                                                                               | 37/400 [00:02&lt;00:11, 30.60it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 11%|████████████████████▋                                                                                                                                                                            | 43/400 [00:02&lt;00:09, 35.95it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 12%|███████████████████████▋                                                                                                                                                                         | 49/400 [00:03&lt;00:08, 39.37it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 14%|██████████████████████████▌                                                                                                                                                                      | 55/400 [00:03&lt;00:07, 44.06it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 16%|█████████████████████████████▉                                                                                                                                                                   | 62/400 [00:03&lt;00:06, 48.43it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 17%|████████████████████████████████▊                                                                                                                                                                | 68/400 [00:03&lt;00:06, 49.24it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 18%|███████████████████████████████████▋                                                                                                                                                             | 74/400 [00:03&lt;00:06, 50.58it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 20%|███████████████████████████████████████                                                                                                                                                          | 81/400 [00:03&lt;00:05, 53.36it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 22%|█████████████████████████████████████████▉                                                                                                                                                       | 87/400 [00:03&lt;00:05, 54.08it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 23%|████████████████████████████████████████████▊                                                                                                                                                    | 93/400 [00:03&lt;00:05, 54.95it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 25%|████████████████████████████████████████████████                                                                                                                                                | 100/400 [00:04&lt;00:05, 56.22it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 26%|██████████████████████████████████████████████████▉                                                                                                                                             | 106/400 [00:04&lt;00:05, 54.45it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 28%|█████████████████████████████████████████████████████▊                                                                                                                                          | 112/400 [00:04&lt;00:05, 54.41it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 30%|████████████████████████████████████████████████████████▋                                                                                                                                       | 118/400 [00:04&lt;00:05, 55.35it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 31%|███████████████████████████████████████████████████████████▌                                                                                                                                    | 124/400 [00:04&lt;00:05, 54.92it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 32%|██████████████████████████████████████████████████████████████▍                                                                                                                                 | 130/400 [00:04&lt;00:04, 55.21it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 34%|█████████████████████████████████████████████████████████████████▎                                                                                                                              | 136/400 [00:04&lt;00:04, 55.80it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 36%|████████████████████████████████████████████████████████████████████▏                                                                                                                           | 142/400 [00:04&lt;00:04, 56.12it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 37%|███████████████████████████████████████████████████████████████████████                                                                                                                         | 148/400 [00:04&lt;00:04, 56.74it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 38%|█████████████████████████████████████████████████████████████████████████▉                                                                                                                      | 154/400 [00:04&lt;00:04, 57.21it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 40%|████████████████████████████████████████████████████████████████████████████▊                                                                                                                   | 160/400 [00:05&lt;00:04, 57.72it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 42%|███████████████████████████████████████████████████████████████████████████████▋                                                                                                                | 166/400 [00:05&lt;00:04, 57.57it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 43%|███████████████████████████████████████████████████████████████████████████████████                                                                                                             | 173/400 [00:05&lt;00:03, 59.07it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 45%|█████████████████████████████████████████████████████████████████████████████████████▉                                                                                                          | 179/400 [00:05&lt;00:03, 56.36it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 46%|█████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                      | 186/400 [00:05&lt;00:03, 58.91it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 48%|████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                   | 192/400 [00:05&lt;00:03, 58.22it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 50%|███████████████████████████████████████████████████████████████████████████████████████████████                                                                                                 | 198/400 [00:05&lt;00:03, 55.35it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 205/400 [00:05&lt;00:03, 57.91it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                          | 211/400 [00:05&lt;00:03, 57.49it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 54%|████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                       | 217/400 [00:06&lt;00:03, 55.49it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                     | 223/400 [00:06&lt;00:03, 54.81it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                  | 229/400 [00:06&lt;00:03, 54.70it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                               | 235/400 [00:06&lt;00:03, 54.31it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 60%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                           | 242/400 [00:06&lt;00:02, 56.91it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 62%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 248/400 [00:06&lt;00:02, 57.09it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                      | 254/400 [00:06&lt;00:02, 56.68it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 65%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                   | 260/400 [00:06&lt;00:02, 56.28it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 66%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                | 266/400 [00:06&lt;00:02, 56.01it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 68%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                             | 273/400 [00:07&lt;00:02, 57.94it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 70%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                          | 279/400 [00:07&lt;00:02, 57.28it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                       | 285/400 [00:07&lt;00:02, 56.11it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 291/400 [00:07&lt;00:01, 55.11it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 74%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                 | 298/400 [00:07&lt;00:01, 57.42it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                              | 304/400 [00:07&lt;00:01, 57.49it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                           | 310/400 [00:07&lt;00:01, 57.05it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                       | 317/400 [00:07&lt;00:01, 58.38it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                     | 323/400 [00:07&lt;00:01, 58.43it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                  | 329/400 [00:08&lt;00:01, 54.75it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                              | 336/400 [00:08&lt;00:01, 56.59it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                           | 343/400 [00:08&lt;00:00, 57.33it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                        | 350/400 [00:08&lt;00:00, 59.15it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                     | 356/400 [00:08&lt;00:00, 58.43it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                  | 362/400 [00:08&lt;00:00, 58.06it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 368/400 [00:08&lt;00:00, 58.46it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████            | 375/400 [00:08&lt;00:00, 59.85it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉         | 381/400 [00:08&lt;00:00, 58.80it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 387/400 [00:09&lt;00:00, 58.44it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋   | 393/400 [00:09&lt;00:00, 57.85it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌| 399/400 [00:09&lt;00:00, 56.26it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:09&lt;00:00, 43.09it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Proses pembacaan data selesai.
Total file berhasil dibaca: 400

Contoh data pertama yang dimuat:
{&#39;filename&#39;: &#39;voice-recorder-2025-11-02--13-08-14.wav&#39;, &#39;signal&#39;: array([ 0.        ,  0.        ,  0.        , ..., -0.00015259,
       -0.00039673, -0.00042725], shape=(57344,), dtype=float32), &#39;sampling_rate&#39;: 16000, &#39;label_buka&#39;: 1, &#39;label_tutup&#39;: 0, &#39;label_fikri&#39;: 1, &#39;label_fauzan&#39;: 0}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="ekstraksi-fitur">
<h2><strong>Ekstraksi Fitur</strong><a class="headerlink" href="#ekstraksi-fitur" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">extract_features_tsfel</span><span class="p">(</span><span class="n">data_list</span><span class="p">):</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">tsfel</span><span class="o">.</span><span class="n">get_features_by_domain</span><span class="p">()</span>
    
    <span class="n">feature_dfs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Memulai proses ekstraksi fitur TSFEL untuk </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> file...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">data_list</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">)):</span>
        <span class="n">signal</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;signal&#39;</span><span class="p">]</span>
        <span class="n">sr</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;sampling_rate&#39;</span><span class="p">]</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">features</span> <span class="o">=</span> <span class="n">tsfel</span><span class="o">.</span><span class="n">time_series_features_extractor</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            
            <span class="n">features</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span>
            <span class="n">features</span><span class="p">[</span><span class="s1">&#39;label_buka&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;label_buka&#39;</span><span class="p">]</span>
            <span class="n">features</span><span class="p">[</span><span class="s1">&#39;label_tutup&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;label_tutup&#39;</span><span class="p">]</span>
            <span class="n">features</span><span class="p">[</span><span class="s1">&#39;label_fikri&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;label_fikri&#39;</span><span class="p">]</span>
            <span class="n">features</span><span class="p">[</span><span class="s1">&#39;label_fauzan&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;label_fauzan&#39;</span><span class="p">]</span>
            
            <span class="n">feature_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Error saat ekstraksi fitur </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">feature_dfs</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tidak ada fitur yang berhasil diekstrak.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        
    <span class="n">feature_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">feature_dfs</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Ekstraksi fitur selesai!&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total data fitur: </span><span class="si">{</span><span class="n">feature_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> baris, </span><span class="si">{</span><span class="n">feature_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> kolom&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">feature_df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- Bagian Eksekusi ---</span>
<span class="k">if</span> <span class="s1">&#39;data_list&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Menjalankan ekstraksi fitur pada &#39;data_list&#39; yang sudah dimuat...&quot;</span><span class="p">)</span>
    <span class="n">features_df</span> <span class="o">=</span> <span class="n">extract_features_tsfel</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Contoh 5 baris pertama dari DataFrame fitur (features_df):&quot;</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">features_df</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR: Variabel &#39;data_list&#39; tidak ditemukan. Jalankan ulang Cell 4.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Menjalankan ekstraksi fitur pada &#39;data_list&#39; yang sudah dimuat...

Memulai proses ekstraksi fitur TSFEL untuk 400 file...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|                                                                                                                                                                                                          | 0/400 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|▍                                                                                                                                                                                                 | 1/400 [00:00&lt;02:43,  2.45it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|▉                                                                                                                                                                                                 | 2/400 [00:00&lt;02:42,  2.45it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1%|█▍                                                                                                                                                                                                | 3/400 [00:01&lt;02:45,  2.41it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1%|█▉                                                                                                                                                                                                | 4/400 [00:01&lt;02:30,  2.63it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1%|██▍                                                                                                                                                                                               | 5/400 [00:02&lt;02:40,  2.46it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  2%|██▉                                                                                                                                                                                               | 6/400 [00:02&lt;03:56,  1.67it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  2%|███▍                                                                                                                                                                                              | 7/400 [00:03&lt;03:21,  1.95it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  2%|███▉                                                                                                                                                                                              | 8/400 [00:04&lt;03:48,  1.71it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  2%|████▎                                                                                                                                                                                             | 9/400 [00:04&lt;04:26,  1.47it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  2%|████▊                                                                                                                                                                                            | 10/400 [00:05&lt;04:41,  1.38it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  3%|█████▎                                                                                                                                                                                           | 11/400 [00:06&lt;03:46,  1.72it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  3%|█████▊                                                                                                                                                                                           | 12/400 [00:06&lt;03:05,  2.09it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  3%|██████▎                                                                                                                                                                                          | 13/400 [00:06&lt;03:00,  2.14it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  4%|██████▊                                                                                                                                                                                          | 14/400 [00:07&lt;02:46,  2.32it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  4%|███████▏                                                                                                                                                                                         | 15/400 [00:07&lt;02:38,  2.43it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  4%|███████▋                                                                                                                                                                                         | 16/400 [00:07&lt;02:46,  2.30it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  4%|████████▏                                                                                                                                                                                        | 17/400 [00:08&lt;03:48,  1.67it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  4%|████████▋                                                                                                                                                                                        | 18/400 [00:09&lt;03:18,  1.93it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  5%|█████████▏                                                                                                                                                                                       | 19/400 [00:09&lt;03:01,  2.10it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  5%|█████████▋                                                                                                                                                                                       | 20/400 [00:10&lt;03:53,  1.63it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  5%|██████████▏                                                                                                                                                                                      | 21/400 [00:11&lt;03:36,  1.75it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  6%|██████████▌                                                                                                                                                                                      | 22/400 [00:11&lt;04:08,  1.52it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  6%|███████████                                                                                                                                                                                      | 23/400 [00:12&lt;04:59,  1.26it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  6%|███████████▌                                                                                                                                                                                     | 24/400 [00:13&lt;05:08,  1.22it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  6%|████████████                                                                                                                                                                                     | 25/400 [00:14&lt;04:33,  1.37it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  6%|████████████▌                                                                                                                                                                                    | 26/400 [00:15&lt;05:14,  1.19it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  7%|█████████████                                                                                                                                                                                    | 27/400 [00:15&lt;04:13,  1.47it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  7%|█████████████▌                                                                                                                                                                                   | 28/400 [00:16&lt;04:57,  1.25it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  7%|█████████████▉                                                                                                                                                                                   | 29/400 [00:18&lt;05:48,  1.07it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  8%|██████████████▍                                                                                                                                                                                  | 30/400 [00:18&lt;04:46,  1.29it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  8%|██████████████▉                                                                                                                                                                                  | 31/400 [00:19&lt;05:20,  1.15it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  8%|███████████████▍                                                                                                                                                                                 | 32/400 [00:19&lt;04:25,  1.38it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  8%|███████████████▉                                                                                                                                                                                 | 33/400 [00:20&lt;03:53,  1.57it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  8%|████████████████▍                                                                                                                                                                                | 34/400 [00:21&lt;04:42,  1.30it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  9%|████████████████▉                                                                                                                                                                                | 35/400 [00:21&lt;03:45,  1.62it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  9%|█████████████████▎                                                                                                                                                                               | 36/400 [00:22&lt;03:34,  1.70it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  9%|█████████████████▊                                                                                                                                                                               | 37/400 [00:23&lt;04:00,  1.51it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 10%|██████████████████▎                                                                                                                                                                              | 38/400 [00:23&lt;03:34,  1.69it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 10%|██████████████████▊                                                                                                                                                                              | 39/400 [00:24&lt;04:13,  1.43it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 10%|███████████████████▎                                                                                                                                                                             | 40/400 [00:24&lt;03:18,  1.81it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 10%|███████████████████▊                                                                                                                                                                             | 41/400 [00:24&lt;02:43,  2.20it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 10%|████████████████████▎                                                                                                                                                                            | 42/400 [00:26&lt;03:51,  1.54it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 11%|████████████████████▋                                                                                                                                                                            | 43/400 [00:26&lt;04:10,  1.42it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 11%|█████████████████████▏                                                                                                                                                                           | 44/400 [00:27&lt;03:36,  1.64it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 11%|█████████████████████▋                                                                                                                                                                           | 45/400 [00:27&lt;03:33,  1.66it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 12%|██████████████████████▏                                                                                                                                                                          | 46/400 [00:28&lt;03:16,  1.80it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 12%|██████████████████████▋                                                                                                                                                                          | 47/400 [00:29&lt;04:12,  1.40it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 12%|██████████████████████▋                                                                                                                                                                          | 47/400 [00:30&lt;03:45,  1.57it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>D:\Perkuliahan\Semester 5\Poyek Sains Data\PSD\venv_py\Lib\site-packages\tsfel\feature_extraction\calc_features.py:195: SyntaxWarning: invalid escape sequence &#39;\*&#39;
  \**kwargs:
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">line</span> <span class="mi">4</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="k">if</span> <span class="s1">&#39;data_list&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">():</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Menjalankan ekstraksi fitur pada &#39;data_list&#39; yang sudah dimuat...&quot;</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">4</span>     <span class="n">features_df</span> <span class="o">=</span> <span class="n">extract_features_tsfel</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Contoh 5 baris pertama dari DataFrame fitur (features_df):&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>     <span class="n">display</span><span class="p">(</span><span class="n">features_df</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>

<span class="nn">Cell In[4], line 12,</span> in <span class="ni">extract_features_tsfel</span><span class="nt">(data_list)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="n">sr</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;sampling_rate&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">12</span>     <span class="n">features</span> <span class="o">=</span> <span class="n">tsfel</span><span class="o">.</span><span class="n">time_series_features_extractor</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span>     <span class="n">features</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span>     <span class="n">features</span><span class="p">[</span><span class="s1">&#39;label_buka&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;label_buka&#39;</span><span class="p">]</span>

<span class="nn">File D:\Perkuliahan\Semester 5\Poyek Sains Data\PSD\venv_py\Lib\site-packages\tsfel\feature_extraction\calc_features.py:379,</span> in <span class="ni">time_series_features_extractor</span><span class="nt">(config, timeseries, fs, window_size, overlap, verbose, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">374</span>         <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">375</span>             <span class="s2">&quot;n_jobs value is not valid. &quot;</span> <span class="s2">&quot;Choose an integer value or None for no multiprocessing.&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">376</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">377</span> <span class="c1"># single window</span>
<span class="g g-Whitespace">    </span><span class="mi">378</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">379</span>     <span class="n">features_final</span> <span class="o">=</span> <span class="n">calc_window_features</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">380</span>         <span class="n">config</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">381</span>         <span class="n">timeseries</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">382</span>         <span class="n">fs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">383</span>         <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">384</span>         <span class="n">features_path</span><span class="o">=</span><span class="n">features_path</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">385</span>         <span class="n">header_names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">386</span>         <span class="n">single_window</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">387</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">389</span> <span class="c1"># Assuring the same feature extraction order</span>
<span class="g g-Whitespace">    </span><span class="mi">390</span> <span class="n">features_final</span> <span class="o">=</span> <span class="n">features_final</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">features_final</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nn">File D:\Perkuliahan\Semester 5\Poyek Sains Data\PSD\venv_py\Lib\site-packages\tsfel\feature_extraction\calc_features.py:509,</span> in <span class="ni">calc_window_features</span><span class="nt">(config, window, fs, verbose, single_window, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">507</span> <span class="c1"># Eval feature results</span>
<span class="g g-Whitespace">    </span><span class="mi">508</span> <span class="k">if</span> <span class="n">single_axis</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">509</span>     <span class="n">eval_result</span> <span class="o">=</span> <span class="n">feature_funcs</span><span class="p">[</span><span class="n">func_total</span><span class="p">](</span>
<span class="g g-Whitespace">    </span><span class="mi">510</span>         <span class="n">window</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">511</span>         <span class="o">**</span><span class="n">parameters_total</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">512</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">513</span>     <span class="n">eval_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">eval_result</span><span class="p">])</span>
<span class="g g-Whitespace">    </span><span class="mi">515</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">header_names</span><span class="p">)):</span>

<span class="nn">File D:\Perkuliahan\Semester 5\Poyek Sains Data\PSD\venv_py\Lib\site-packages\tsfel\feature_extraction\features.py:1238,</span> in <span class="ni">spectral_slope</span><span class="nt">(signal, fs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1213</span> <span class="nd">@set_domain</span><span class="p">(</span><span class="s2">&quot;domain&quot;</span><span class="p">,</span> <span class="s2">&quot;spectral&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1214</span> <span class="k">def</span><span class="w"> </span><span class="nf">spectral_slope</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">fs</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1215</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Computes the spectral slope.</span>
<span class="g g-Whitespace">   </span><span class="mi">1216</span><span class="sd"> </span>
<span class="g g-Whitespace">   </span><span class="mi">1217</span><span class="sd">     Spectral slope is computed by finding constants m and b of the function aFFT = mf + b, obtained by linear regression</span>
<span class="sd">   (...)   1236         Spectral Slope</span>
<span class="g g-Whitespace">   </span><span class="mi">1237</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1238</span>     <span class="n">f</span><span class="p">,</span> <span class="n">fmag</span> <span class="o">=</span> <span class="n">calc_fft</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1239</span>     <span class="n">sum_fmag</span> <span class="o">=</span> <span class="n">fmag</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1240</span>     <span class="n">dot_ff</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="nn">File D:\Perkuliahan\Semester 5\Poyek Sains Data\PSD\venv_py\Lib\site-packages\tsfel\feature_extraction\features_utils.py:73,</span> in <span class="ni">calc_fft</span><span class="nt">(signal, fs)</span>
<span class="g g-Whitespace">     </span><span class="mi">55</span> <span class="k">def</span><span class="w"> </span><span class="nf">calc_fft</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">fs</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">56</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;This functions computes the fft of a signal.</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span><span class="sd"> </span>
<span class="g g-Whitespace">     </span><span class="mi">58</span><span class="sd">     Parameters</span>
<span class="sd">   (...)     70         Amplitude of the frequency values (yy axis)</span>
<span class="g g-Whitespace">     </span><span class="mi">71</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">---&gt; </span><span class="mi">73</span>     <span class="n">fmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span>     <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">),</span> <span class="n">d</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">76</span>     <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">fmag</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nn">File D:\Perkuliahan\Semester 5\Poyek Sains Data\PSD\venv_py\Lib\site-packages\numpy\fft\_pocketfft.py:417,</span> in <span class="ni">rfft</span><span class="nt">(a, n, axis, norm, out)</span>
<span class="g g-Whitespace">    </span><span class="mi">415</span> <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">416</span>     <span class="n">n</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
<span class="ne">--&gt; </span><span class="mi">417</span> <span class="n">output</span> <span class="o">=</span> <span class="n">_raw_fft</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">418</span> <span class="k">return</span> <span class="n">output</span>

<span class="nn">File D:\Perkuliahan\Semester 5\Poyek Sains Data\PSD\venv_py\Lib\site-packages\numpy\fft\_pocketfft.py:101,</span> in <span class="ni">_raw_fft</span><span class="nt">(a, n, axis, is_real, is_forward, norm, out)</span>
<span class="g g-Whitespace">     </span><span class="mi">97</span> <span class="k">elif</span> <span class="p">((</span><span class="n">shape</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="s2">&quot;shape&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">     </span><span class="mi">98</span>       <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">or</span> <span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">!=</span> <span class="n">n_out</span><span class="p">)):</span>
<span class="g g-Whitespace">     </span><span class="mi">99</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;output array has wrong shape.&quot;</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">101</span> <span class="k">return</span> <span class="n">ufunc</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">fct</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[(</span><span class="n">axis</span><span class="p">,),</span> <span class="p">(),</span> <span class="p">(</span><span class="n">axis</span><span class="p">,)],</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">)</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">features_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0_Absolute energy
0_Area under the curve
0_Autocorrelation
0_Average power
0_Centroid
0_ECDF Percentile Count_0
0_ECDF Percentile Count_1
0_ECDF Percentile_0
0_ECDF Percentile_1
0_ECDF_0
0_ECDF_1
0_ECDF_2
0_ECDF_3
0_ECDF_4
0_ECDF_5
0_ECDF_6
0_ECDF_7
0_ECDF_8
0_ECDF_9
0_Entropy
0_Fundamental frequency
0_Histogram mode
0_Human range energy
0_Interquartile range
0_Kurtosis
0_LPCC_0
0_LPCC_1
0_LPCC_10
0_LPCC_11
0_LPCC_2
0_LPCC_3
0_LPCC_4
0_LPCC_5
0_LPCC_6
0_LPCC_7
0_LPCC_8
0_LPCC_9
0_MFCC_0
0_MFCC_1
0_MFCC_10
0_MFCC_11
0_MFCC_2
0_MFCC_3
0_MFCC_4
0_MFCC_5
0_MFCC_6
0_MFCC_7
0_MFCC_8
0_MFCC_9
0_Max
0_Max power spectrum
0_Maximum frequency
0_Mean
0_Mean absolute deviation
0_Mean absolute diff
0_Mean diff
0_Median
0_Median absolute deviation
0_Median absolute diff
0_Median diff
0_Median frequency
0_Min
0_Negative turning points
0_Neighbourhood peaks
0_Peak to peak distance
0_Positive turning points
0_Power bandwidth
0_Root mean square
0_Signal distance
0_Skewness
0_Slope
0_Spectral centroid
0_Spectral decrease
0_Spectral distance
0_Spectral entropy
0_Spectral kurtosis
0_Spectral positive turning points
0_Spectral roll-off
0_Spectral roll-on
0_Spectral skewness
0_Spectral slope
0_Spectral spread
0_Spectral variation
0_Spectrogram mean coefficient_0.0Hz
0_Spectrogram mean coefficient_1032.26Hz
0_Spectrogram mean coefficient_1290.32Hz
0_Spectrogram mean coefficient_1548.39Hz
0_Spectrogram mean coefficient_1806.45Hz
0_Spectrogram mean coefficient_2064.52Hz
0_Spectrogram mean coefficient_2322.58Hz
0_Spectrogram mean coefficient_258.06Hz
0_Spectrogram mean coefficient_2580.65Hz
0_Spectrogram mean coefficient_2838.71Hz
0_Spectrogram mean coefficient_3096.77Hz
0_Spectrogram mean coefficient_3354.84Hz
0_Spectrogram mean coefficient_3612.9Hz
0_Spectrogram mean coefficient_3870.97Hz
0_Spectrogram mean coefficient_4129.03Hz
0_Spectrogram mean coefficient_4387.1Hz
0_Spectrogram mean coefficient_4645.16Hz
0_Spectrogram mean coefficient_4903.23Hz
0_Spectrogram mean coefficient_516.13Hz
0_Spectrogram mean coefficient_5161.29Hz
0_Spectrogram mean coefficient_5419.35Hz
0_Spectrogram mean coefficient_5677.42Hz
0_Spectrogram mean coefficient_5935.48Hz
0_Spectrogram mean coefficient_6193.55Hz
0_Spectrogram mean coefficient_6451.61Hz
0_Spectrogram mean coefficient_6709.68Hz
0_Spectrogram mean coefficient_6967.74Hz
0_Spectrogram mean coefficient_7225.81Hz
0_Spectrogram mean coefficient_7483.87Hz
0_Spectrogram mean coefficient_774.19Hz
0_Spectrogram mean coefficient_7741.94Hz
0_Spectrogram mean coefficient_8000.0Hz
0_Standard deviation
0_Sum absolute diff
0_Variance
0_Wavelet absolute mean_1000.0Hz
0_Wavelet absolute mean_1333.33Hz
0_Wavelet absolute mean_2000.0Hz
0_Wavelet absolute mean_4000.0Hz
0_Wavelet absolute mean_444.44Hz
0_Wavelet absolute mean_500.0Hz
0_Wavelet absolute mean_571.43Hz
0_Wavelet absolute mean_666.67Hz
0_Wavelet absolute mean_800.0Hz
0_Wavelet energy_1000.0Hz
0_Wavelet energy_1333.33Hz
0_Wavelet energy_2000.0Hz
0_Wavelet energy_4000.0Hz
0_Wavelet energy_444.44Hz
0_Wavelet energy_500.0Hz
0_Wavelet energy_571.43Hz
0_Wavelet energy_666.67Hz
0_Wavelet energy_800.0Hz
0_Wavelet entropy
0_Wavelet standard deviation_1000.0Hz
0_Wavelet standard deviation_1333.33Hz
0_Wavelet standard deviation_2000.0Hz
0_Wavelet standard deviation_4000.0Hz
0_Wavelet standard deviation_444.44Hz
0_Wavelet standard deviation_500.0Hz
0_Wavelet standard deviation_571.43Hz
0_Wavelet standard deviation_666.67Hz
0_Wavelet standard deviation_800.0Hz
0_Wavelet variance_1000.0Hz
0_Wavelet variance_1333.33Hz
0_Wavelet variance_2000.0Hz
0_Wavelet variance_4000.0Hz
0_Wavelet variance_444.44Hz
0_Wavelet variance_500.0Hz
0_Wavelet variance_571.43Hz
0_Wavelet variance_666.67Hz
0_Wavelet variance_800.0Hz
0_Zero crossing rate
filename
label_buka
label_tutup
label_fikri
label_fauzan
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_feature_domain</span><span class="p">(</span><span class="n">feature_name</span><span class="p">):</span>
    <span class="c1"># Hapus prefix &#39;0_&#39; untuk memudahkan pencocokan</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">feature_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;0_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="c1"># --- Domain SPECTRAL ---</span>
    <span class="n">spectral_keywords</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;Spectral&#39;</span><span class="p">,</span> <span class="s1">&#39;Spectrogram&#39;</span><span class="p">,</span> <span class="s1">&#39;Wavelet&#39;</span><span class="p">,</span> <span class="s1">&#39;Fundamental frequency&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Human range energy&#39;</span><span class="p">,</span> <span class="s1">&#39;LPCC&#39;</span><span class="p">,</span> <span class="s1">&#39;MFCC&#39;</span><span class="p">,</span> <span class="s1">&#39;Max power spectrum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Maximum frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;Median frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;Power bandwidth&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Average power&#39;</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">keyword</span> <span class="ow">in</span> <span class="n">name</span> <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">spectral_keywords</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Spectral&#39;</span>

    <span class="c1"># --- Domain TEMPORAL ---</span>
    <span class="n">temporal_keywords</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;Absolute energy&#39;</span><span class="p">,</span> <span class="s1">&#39;Area under the curve&#39;</span><span class="p">,</span> <span class="s1">&#39;Autocorrelation&#39;</span><span class="p">,</span> <span class="s1">&#39;Centroid&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Mean absolute diff&#39;</span><span class="p">,</span> <span class="s1">&#39;Mean diff&#39;</span><span class="p">,</span> <span class="s1">&#39;Median absolute diff&#39;</span><span class="p">,</span> <span class="s1">&#39;Median diff&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Negative turning points&#39;</span><span class="p">,</span> <span class="s1">&#39;Neighbourhood peaks&#39;</span><span class="p">,</span> <span class="s1">&#39;Peak to peak distance&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Positive turning points&#39;</span><span class="p">,</span> <span class="s1">&#39;Signal distance&#39;</span><span class="p">,</span> <span class="s1">&#39;Slope&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum absolute diff&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Zero crossing rate&#39;</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">keyword</span> <span class="ow">in</span> <span class="n">name</span> <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">temporal_keywords</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Temporal&#39;</span>

    <span class="c1"># --- Domain STATISTICAL ---</span>
    <span class="c1"># Jika bukan Spectral atau Temporal, kemungkinan besar Statistical</span>
    <span class="n">statistical_keywords</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;ECDF&#39;</span><span class="p">,</span> <span class="s1">&#39;Entropy&#39;</span><span class="p">,</span> <span class="s1">&#39;Histogram&#39;</span><span class="p">,</span> <span class="s1">&#39;Interquartile range&#39;</span><span class="p">,</span> <span class="s1">&#39;Kurtosis&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Max&#39;</span><span class="p">,</span> <span class="s1">&#39;Min&#39;</span><span class="p">,</span> <span class="s1">&#39;Mean&#39;</span><span class="p">,</span> <span class="s1">&#39;Median&#39;</span><span class="p">,</span> <span class="s1">&#39;Root mean square&#39;</span><span class="p">,</span> <span class="s1">&#39;Skewness&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Standard deviation&#39;</span><span class="p">,</span> <span class="s1">&#39;Variance&#39;</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">keyword</span> <span class="ow">in</span> <span class="n">name</span> <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">statistical_keywords</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Statistical&#39;</span>

    <span class="c1"># --- Lainnya (Label atau fitur tak dikenal) ---</span>
    <span class="k">return</span> <span class="s1">&#39;Other&#39;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">cek_domain</span><span class="p">(</span><span class="n">nama_fitur_dicari</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fungsi untuk mencari domain dari sebuah fitur secara cepat.</span>
<span class="sd">    Cukup masukkan sebagian nama fitur.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hasil</span> <span class="o">=</span> <span class="n">feature_metadata</span><span class="p">[</span><span class="n">feature_metadata</span><span class="p">[</span><span class="s1">&#39;Fitur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">nama_fitur_dicari</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">hasil</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tidak ditemukan fitur yang mengandung kata &#39;</span><span class="si">{</span><span class="n">nama_fitur_dicari</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Hasil pencarian untuk &#39;</span><span class="si">{</span><span class="n">nama_fitur_dicari</span><span class="si">}</span><span class="s2">&#39;:&quot;</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">hasil</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_features</span> <span class="o">=</span> <span class="n">features_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>


<span class="n">feature_metadata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Fitur&#39;</span><span class="p">:</span> <span class="n">all_features</span><span class="p">,</span>
    <span class="s1">&#39;Domain&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">get_feature_domain</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">all_features</span><span class="p">]</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">feature_metadata</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                      Fitur    Domain
0         0_Absolute energy  Temporal
1    0_Area under the curve  Temporal
2         0_Autocorrelation  Temporal
3           0_Average power  Spectral
4                0_Centroid  Temporal
..                      ...       ...
156                filename     Other
157              label_buka     Other
158             label_tutup     Other
159             label_fikri     Other
160            label_fauzan     Other

[161 rows x 2 columns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cek_domain</span><span class="p">(</span><span class="s1">&#39;Zero crossing rate&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Hasil pencarian untuk &#39;Zero crossing rate&#39;:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Fitur</th>
      <th>Domain</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>155</th>
      <td>0_Zero crossing rate</td>
      <td>Temporal</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="seleksi-fitur-menggunakan-penilaian-score-dari-information-gain">
<h2><strong>Seleksi Fitur Menggunakan Penilaian Score dari Information Gain</strong><a class="headerlink" href="#seleksi-fitur-menggunakan-penilaian-score-dari-information-gain" title="Link to this heading">#</a></h2>
<section id="visualisasi-score-fitur-information-gain">
<h3><em>Visualisasi Score Fitur Information Gain</em><a class="headerlink" href="#visualisasi-score-fitur-information-gain" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">feature_metadata</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">features_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                      Fitur    Domain
0         0_Absolute energy  Temporal
1    0_Area under the curve  Temporal
2         0_Autocorrelation  Temporal
3           0_Average power  Spectral
4                0_Centroid  Temporal
..                      ...       ...
156                filename     Other
157              label_buka     Other
158             label_tutup     Other
159             label_fikri     Other
160            label_fauzan     Other

[161 rows x 2 columns]
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0_Absolute energy</th>
      <th>0_Area under the curve</th>
      <th>0_Autocorrelation</th>
      <th>0_Average power</th>
      <th>0_Centroid</th>
      <th>0_ECDF Percentile Count_0</th>
      <th>0_ECDF Percentile Count_1</th>
      <th>0_ECDF Percentile_0</th>
      <th>0_ECDF Percentile_1</th>
      <th>0_ECDF_0</th>
      <th>...</th>
      <th>0_Wavelet variance_500.0Hz</th>
      <th>0_Wavelet variance_571.43Hz</th>
      <th>0_Wavelet variance_666.67Hz</th>
      <th>0_Wavelet variance_800.0Hz</th>
      <th>0_Zero crossing rate</th>
      <th>filename</th>
      <th>label_buka</th>
      <th>label_tutup</th>
      <th>label_fikri</th>
      <th>label_fauzan</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>199.916886</td>
      <td>0.083649</td>
      <td>9.0</td>
      <td>55.781354</td>
      <td>1.834369</td>
      <td>11468.0</td>
      <td>45875.0</td>
      <td>-0.002777</td>
      <td>0.001709</td>
      <td>0.000017</td>
      <td>...</td>
      <td>0.042812</td>
      <td>0.031659</td>
      <td>0.020734</td>
      <td>0.011845</td>
      <td>9625.0</td>
      <td>voice-recorder-2025-11-02--13-08-14.wav</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1362.971628</td>
      <td>0.236500</td>
      <td>9.0</td>
      <td>354.946305</td>
      <td>1.213369</td>
      <td>12288.0</td>
      <td>49152.0</td>
      <td>-0.009888</td>
      <td>0.005280</td>
      <td>0.000016</td>
      <td>...</td>
      <td>0.286443</td>
      <td>0.213464</td>
      <td>0.139822</td>
      <td>0.079558</td>
      <td>5721.0</td>
      <td>voice-recorder-2025-11-02--13-08-24.wav</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>866.602132</td>
      <td>0.211150</td>
      <td>11.0</td>
      <td>225.681312</td>
      <td>0.978502</td>
      <td>12288.0</td>
      <td>49152.0</td>
      <td>-0.034424</td>
      <td>0.016479</td>
      <td>0.000016</td>
      <td>...</td>
      <td>0.144419</td>
      <td>0.104278</td>
      <td>0.065776</td>
      <td>0.035207</td>
      <td>5820.0</td>
      <td>voice-recorder-2025-11-02--13-08-30.wav</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1146.513636</td>
      <td>0.195138</td>
      <td>10.0</td>
      <td>407.151663</td>
      <td>0.775227</td>
      <td>9011.0</td>
      <td>36044.0</td>
      <td>-0.016052</td>
      <td>0.007629</td>
      <td>0.000022</td>
      <td>...</td>
      <td>0.308509</td>
      <td>0.218079</td>
      <td>0.134105</td>
      <td>0.069515</td>
      <td>4266.0</td>
      <td>voice-recorder-2025-11-02--13-08-36.wav</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>728.751226</td>
      <td>0.170527</td>
      <td>10.0</td>
      <td>194.094277</td>
      <td>0.848770</td>
      <td>12015.0</td>
      <td>48060.0</td>
      <td>-0.019287</td>
      <td>0.009216</td>
      <td>0.000017</td>
      <td>...</td>
      <td>0.157957</td>
      <td>0.114189</td>
      <td>0.072037</td>
      <td>0.038522</td>
      <td>5482.0</td>
      <td>voice-recorder-2025-11-02--13-08-43.wav</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>395</th>
      <td>48.708238</td>
      <td>0.034236</td>
      <td>11.0</td>
      <td>32.778087</td>
      <td>0.910325</td>
      <td>4755.0</td>
      <td>19021.0</td>
      <td>-0.011627</td>
      <td>0.003479</td>
      <td>0.000042</td>
      <td>...</td>
      <td>0.021085</td>
      <td>0.014759</td>
      <td>0.009092</td>
      <td>0.004755</td>
      <td>3143.0</td>
      <td>tutup51.wav</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>396</th>
      <td>30.968305</td>
      <td>0.032147</td>
      <td>11.0</td>
      <td>15.691078</td>
      <td>1.212779</td>
      <td>6315.0</td>
      <td>25263.0</td>
      <td>-0.012054</td>
      <td>0.004761</td>
      <td>0.000032</td>
      <td>...</td>
      <td>0.007665</td>
      <td>0.005636</td>
      <td>0.003765</td>
      <td>0.002213</td>
      <td>4508.0</td>
      <td>tutup60.wav</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>397</th>
      <td>192.899147</td>
      <td>0.069760</td>
      <td>10.0</td>
      <td>143.239725</td>
      <td>0.819033</td>
      <td>4309.0</td>
      <td>17238.0</td>
      <td>-0.031921</td>
      <td>0.011139</td>
      <td>0.000046</td>
      <td>...</td>
      <td>0.111300</td>
      <td>0.078908</td>
      <td>0.049298</td>
      <td>0.026483</td>
      <td>3100.0</td>
      <td>tutup70.wav</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>398</th>
      <td>1012.776862</td>
      <td>0.197376</td>
      <td>8.0</td>
      <td>581.575200</td>
      <td>1.089950</td>
      <td>5572.0</td>
      <td>22291.0</td>
      <td>-0.091156</td>
      <td>0.051941</td>
      <td>0.000036</td>
      <td>...</td>
      <td>0.574797</td>
      <td>0.443706</td>
      <td>0.296495</td>
      <td>0.166380</td>
      <td>2548.0</td>
      <td>tutup80.wav</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>399</th>
      <td>767.297788</td>
      <td>0.141257</td>
      <td>8.0</td>
      <td>550.774545</td>
      <td>0.765989</td>
      <td>4458.0</td>
      <td>17832.0</td>
      <td>-0.065430</td>
      <td>0.021423</td>
      <td>0.000045</td>
      <td>...</td>
      <td>0.514554</td>
      <td>0.430745</td>
      <td>0.311610</td>
      <td>0.188728</td>
      <td>1840.0</td>
      <td>tutup90.wav</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>400 rows × 161 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">feature_selection_information_gain</span><span class="p">(</span><span class="n">features_df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Menghitung Information Gain rata-rata setiap fitur terhadap semua label multilabel.</span>
<span class="sd">    Menghapus kolom non-fitur seperti &#39;filename&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># --- 1️⃣ Pisahkan fitur dan label</span>
    <span class="n">label_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;label_buka&#39;</span><span class="p">,</span> <span class="s1">&#39;label_tutup&#39;</span><span class="p">,</span> <span class="s1">&#39;label_fikri&#39;</span><span class="p">,</span> <span class="s1">&#39;label_fauzan&#39;</span><span class="p">]</span>
    <span class="n">feature_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">features_df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">label_cols</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]]</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">features_df</span><span class="p">[</span><span class="n">feature_cols</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">features_df</span><span class="p">[</span><span class="n">label_cols</span><span class="p">]</span>

    <span class="c1"># --- 2️⃣ Imputasi nilai hilang agar tidak error</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">imputer</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">)</span>
    <span class="n">X_imputed</span> <span class="o">=</span> <span class="n">imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="c1"># --- 3️⃣ Hitung IG untuk setiap label, lalu rata-rata</span>
    <span class="n">ig_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">label_cols</span><span class="p">:</span>
        <span class="n">ig</span> <span class="o">=</span> <span class="n">mutual_info_classif</span><span class="p">(</span><span class="n">X_imputed</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">discrete_features</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
        <span class="n">ig_scores</span> <span class="o">+=</span> <span class="n">ig</span>
    <span class="n">ig_scores</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">label_cols</span><span class="p">)</span>

    <span class="c1"># --- 4️⃣ Buat dataframe hasil</span>
    <span class="n">ig_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;feature&#39;</span><span class="p">:</span> <span class="n">feature_cols</span><span class="p">,</span> <span class="s1">&#39;information_gain&#39;</span><span class="p">:</span> <span class="n">ig_scores</span><span class="p">})</span>
    <span class="n">ig_df</span> <span class="o">=</span> <span class="n">ig_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;information_gain&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✅ Information Gain berhasil dihitung.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total fitur: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">feature_cols</span><span class="p">)</span><span class="si">}</span><span class="s2"> | Fitur dengan IG &gt; 0: </span><span class="si">{</span><span class="p">(</span><span class="n">ig_df</span><span class="p">[</span><span class="s1">&#39;information_gain&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ig_df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">evaluate_feature_step</span><span class="p">(</span><span class="n">features_df</span><span class="p">,</span> <span class="n">ig_df</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Mengevaluasi performa Random Forest terhadap subset fitur berdasarkan ranking IG.</span>
<span class="sd">    Menggunakan rata-rata akurasi dari seluruh label multilabel.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">label_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;label_buka&#39;</span><span class="p">,</span> <span class="s1">&#39;label_tutup&#39;</span><span class="p">,</span> <span class="s1">&#39;label_fikri&#39;</span><span class="p">,</span> <span class="s1">&#39;label_fauzan&#39;</span><span class="p">]</span>
    <span class="n">feature_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">features_df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">label_cols</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]]</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">features_df</span><span class="p">[</span><span class="n">feature_cols</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">features_df</span><span class="p">[</span><span class="n">label_cols</span><span class="p">]</span>

    <span class="c1"># urutkan fitur berdasarkan IG</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">ig_df</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>

    <span class="c1"># list jumlah fitur yang diuji</span>
    <span class="n">feature_counts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ig_df</span><span class="p">),</span> <span class="n">step</span><span class="p">,</span> <span class="o">-</span><span class="n">step</span><span class="p">))</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">n_features</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">feature_counts</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Evaluasi per subset fitur&quot;</span><span class="p">):</span>
        <span class="n">selected_features</span> <span class="o">=</span> <span class="n">ig_df</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
        <span class="n">X_sel</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">selected_features</span><span class="p">]</span>

        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_sel</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

        <span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

        <span class="c1"># hitung akurasi rata-rata per label</span>
        <span class="n">accs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">label_cols</span><span class="p">):</span>
            <span class="n">accs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]))</span>
        <span class="n">avg_acc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">accs</span><span class="p">)</span>

        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;jumlah_fitur&#39;</span><span class="p">:</span> <span class="n">n_features</span><span class="p">,</span> <span class="s1">&#39;akurasi&#39;</span><span class="p">:</span> <span class="n">avg_acc</span><span class="p">})</span>

    <span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✅ Evaluasi selesai.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">results_df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_feature_evaluation</span><span class="p">(</span><span class="n">results_df</span><span class="p">):</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

    <span class="n">optimal_idx</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;akurasi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
    <span class="n">optimal_features</span> <span class="o">=</span> <span class="n">results_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">optimal_idx</span><span class="p">,</span> <span class="s1">&#39;jumlah_fitur&#39;</span><span class="p">]</span>
    <span class="n">optimal_acc</span> <span class="o">=</span> <span class="n">results_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">optimal_idx</span><span class="p">,</span> <span class="s1">&#39;akurasi&#39;</span><span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;jumlah_fitur&#39;</span><span class="p">],</span> <span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;akurasi&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Akurasi&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">optimal_features</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Optimal: </span><span class="si">{</span><span class="n">optimal_features</span><span class="si">}</span><span class="s1"> fitur&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Evaluasi Jumlah Fitur vs Akurasi Model (Random Forest)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Jumlah Fitur&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Akurasi Rata-rata&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🌟 Jumlah fitur optimal: </span><span class="si">{</span><span class="n">optimal_features</span><span class="si">}</span><span class="s2"> dengan akurasi </span><span class="si">{</span><span class="n">optimal_acc</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ig_score</span> <span class="o">=</span> <span class="n">feature_selection_information_gain</span><span class="p">(</span><span class="n">features_df</span><span class="p">)</span>

<span class="c1"># Lihat 10 fitur dengan IG tertinggi</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">🔝 10 fitur teratas berdasarkan Information Gain:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ig_score</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✅ Information Gain berhasil dihitung.
Total fitur: 156 | Fitur dengan IG &gt; 0: 154

🔝 10 fitur teratas berdasarkan Information Gain:
                            feature  information_gain
0            0_Median absolute diff          0.363594
1  0_Wavelet absolute mean_4000.0Hz          0.347407
2           0_Fundamental frequency          0.329585
3                         0_Entropy          0.321665
4         0_Negative turning points          0.317573
5  0_Wavelet absolute mean_666.67Hz          0.314800
6         0_Positive turning points          0.314698
7   0_Wavelet absolute mean_800.0Hz          0.313495
8       0_Median absolute deviation          0.312036
9                       0_Mean diff          0.310518
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="n">results_df</span> <span class="o">=</span> <span class="n">evaluate_feature_step</span><span class="p">(</span><span class="n">features_df</span><span class="p">,</span> <span class="n">ig_score</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluasi per subset fitur: 100%|██████████| 155/155 [00:47&lt;00:00,  3.27it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✅ Evaluasi selesai.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="show-score-valuation-with-reduce-feature">
<h3><em>Show Score Valuation with Reduce Feature</em><a class="headerlink" href="#show-score-valuation-with-reduce-feature" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_feature_evaluation</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5088dd59d06856153ef92cd511f0b4ab098b06eee1c06a41b0b01e1e7bb7846f.png" src="_images/5088dd59d06856153ef92cd511f0b4ab098b06eee1c06a41b0b01e1e7bb7846f.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>🌟 Jumlah fitur optimal: 136 dengan akurasi 0.9812
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">features_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0_Absolute energy</th>
      <th>0_Area under the curve</th>
      <th>0_Autocorrelation</th>
      <th>0_Average power</th>
      <th>0_Centroid</th>
      <th>0_ECDF Percentile Count_0</th>
      <th>0_ECDF Percentile Count_1</th>
      <th>0_ECDF Percentile_0</th>
      <th>0_ECDF Percentile_1</th>
      <th>0_ECDF_0</th>
      <th>...</th>
      <th>0_Wavelet variance_444.44Hz</th>
      <th>0_Wavelet variance_500.0Hz</th>
      <th>0_Wavelet variance_571.43Hz</th>
      <th>0_Wavelet variance_666.67Hz</th>
      <th>0_Wavelet variance_800.0Hz</th>
      <th>0_Zero crossing rate</th>
      <th>label_buka</th>
      <th>label_tutup</th>
      <th>label_fikri</th>
      <th>label_fauzan</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>min</th>
      <td>17.647803</td>
      <td>0.018312</td>
      <td>4.0</td>
      <td>10.857681</td>
      <td>0.439086</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-0.203674</td>
      <td>0.000000</td>
      <td>0.000015</td>
      <td>...</td>
      <td>0.007937</td>
      <td>0.005305</td>
      <td>0.003407</td>
      <td>0.002098</td>
      <td>0.001219</td>
      <td>744.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2030.738166</td>
      <td>0.313852</td>
      <td>16.0</td>
      <td>1000.456293</td>
      <td>2.247681</td>
      <td>13653.0</td>
      <td>54613.0</td>
      <td>0.000000</td>
      <td>0.169617</td>
      <td>0.000057</td>
      <td>...</td>
      <td>1.020042</td>
      <td>0.942263</td>
      <td>0.769304</td>
      <td>0.579292</td>
      <td>0.401327</td>
      <td>12996.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 160 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">features_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0_Absolute energy</th>
      <th>0_Area under the curve</th>
      <th>0_Autocorrelation</th>
      <th>0_Average power</th>
      <th>0_Centroid</th>
      <th>0_ECDF Percentile Count_0</th>
      <th>0_ECDF Percentile Count_1</th>
      <th>0_ECDF Percentile_0</th>
      <th>0_ECDF Percentile_1</th>
      <th>0_ECDF_0</th>
      <th>...</th>
      <th>0_Wavelet variance_444.44Hz</th>
      <th>0_Wavelet variance_500.0Hz</th>
      <th>0_Wavelet variance_571.43Hz</th>
      <th>0_Wavelet variance_666.67Hz</th>
      <th>0_Wavelet variance_800.0Hz</th>
      <th>0_Zero crossing rate</th>
      <th>label_buka</th>
      <th>label_tutup</th>
      <th>label_fikri</th>
      <th>label_fauzan</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mean</th>
      <td>475.491686</td>
      <td>0.117370</td>
      <td>9.412500</td>
      <td>211.163508</td>
      <td>1.135094</td>
      <td>7453.457500</td>
      <td>29815.072500</td>
      <td>-0.028997</td>
      <td>0.014775</td>
      <td>0.000028</td>
      <td>...</td>
      <td>0.192242</td>
      <td>0.162426</td>
      <td>0.126586</td>
      <td>0.089455</td>
      <td>0.055902</td>
      <td>5072.917500</td>
      <td>0.500000</td>
      <td>0.500000</td>
      <td>0.500000</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>324.406760</td>
      <td>0.050968</td>
      <td>2.213502</td>
      <td>171.431626</td>
      <td>0.342033</td>
      <td>3077.933461</td>
      <td>12311.967411</td>
      <td>0.036055</td>
      <td>0.020295</td>
      <td>0.000010</td>
      <td>...</td>
      <td>0.176729</td>
      <td>0.156402</td>
      <td>0.127105</td>
      <td>0.094402</td>
      <td>0.063762</td>
      <td>2960.605704</td>
      <td>0.500626</td>
      <td>0.500626</td>
      <td>0.500626</td>
      <td>0.500626</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 160 columns</p>
</div></div></div>
</div>
</section>
<section id="memilih-jumlah-fitur-optimal">
<h3><em>Memilih Jumlah Fitur Optimal</em><a class="headerlink" href="#memilih-jumlah-fitur-optimal" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">select_top_features</span><span class="p">(</span><span class="n">feature_df</span><span class="p">,</span> <span class="n">ig_scores</span><span class="p">,</span> <span class="n">n_features</span><span class="p">):</span>
    <span class="c1"># Ambil nama kolom fitur (bukan kolom label)</span>
    <span class="n">feature_columns</span> <span class="o">=</span> <span class="n">feature_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;label_buka&quot;</span><span class="p">,</span> <span class="s2">&quot;label_tutup&quot;</span><span class="p">,</span> <span class="s2">&quot;label_fikri&quot;</span><span class="p">,</span> <span class="s2">&quot;label_fauzan&quot;</span><span class="p">,</span>
    <span class="p">])</span><span class="o">.</span><span class="n">columns</span>

    <span class="c1"># Pastikan ig_scores jumlah barisnya sama jumlah fitur</span>
    <span class="n">ig_scores</span> <span class="o">=</span> <span class="n">ig_scores</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">ig_scores</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">feature_columns</span>

    <span class="c1"># Urutkan</span>
    <span class="n">score_col</span> <span class="o">=</span> <span class="n">ig_scores</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">top_features</span> <span class="o">=</span> <span class="n">ig_scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">score_col</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>

    <span class="c1"># Return data fitur terpilih</span>
    <span class="k">return</span> <span class="n">feature_df</span><span class="p">[</span><span class="n">top_features</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">select_top_features</span><span class="p">(</span><span class="n">feature_df</span><span class="p">,</span> <span class="n">ig_scores</span><span class="p">,</span> <span class="n">n_features</span><span class="p">):</span>
    <span class="c1"># Kolom yang kemungkinan ada</span>
    <span class="n">drop_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;label_buka&quot;</span><span class="p">,</span> <span class="s2">&quot;label_tutup&quot;</span><span class="p">,</span> <span class="s2">&quot;label_fikri&quot;</span><span class="p">,</span> <span class="s2">&quot;label_fauzan&quot;</span><span class="p">,</span> <span class="s2">&quot;filename&quot;</span><span class="p">]</span>

    <span class="c1"># Filter hanya kolom yang benar-benar ada di dataset</span>
    <span class="n">drop_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">drop_cols</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">feature_df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

    <span class="c1"># Drop yang ada saja</span>
    <span class="n">feature_columns</span> <span class="o">=</span> <span class="n">feature_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">drop_cols</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>

    <span class="c1"># Pastikan panjang ig_scores sesuai jumlah fitur</span>
    <span class="n">ig_scores</span> <span class="o">=</span> <span class="n">ig_scores</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">ig_scores</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">feature_columns</span>

    <span class="c1"># Ambil top N fitur</span>
    <span class="n">score_col</span> <span class="o">=</span> <span class="n">ig_scores</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">top_features</span> <span class="o">=</span> <span class="n">ig_scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">score_col</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>

    <span class="c1"># Kembalikan dataframe dengan fitur terbaik</span>
    <span class="k">return</span> <span class="n">feature_df</span><span class="p">[</span><span class="n">top_features</span><span class="p">],</span> <span class="n">top_features</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="melakukan-normalisai">
<h3><em>Melakukan Normalisai</em><a class="headerlink" href="#melakukan-normalisai" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">normalize_features_minmax</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label_cols</span><span class="p">,</span> <span class="n">scaler_path</span><span class="o">=</span><span class="s2">&quot;scaler_minmax.pkl&quot;</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">label_cols</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">label_cols</span><span class="p">]</span>

    <span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
    <span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">X_scaled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

    <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">scaler</span><span class="p">,</span> <span class="n">scaler_path</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">X_scaled</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">scaler</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">label_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;label_buka&quot;</span><span class="p">,</span> <span class="s2">&quot;label_tutup&quot;</span><span class="p">,</span> <span class="s2">&quot;label_fikri&quot;</span><span class="p">,</span> <span class="s2">&quot;label_fauzan&quot;</span><span class="p">]</span>

<span class="n">features_df_clean</span> <span class="o">=</span> <span class="n">features_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">])</span>

<span class="n">X_scaled</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">scaler</span> <span class="o">=</span> <span class="n">normalize_features_minmax</span><span class="p">(</span><span class="n">features_df_clean</span><span class="p">,</span> <span class="n">label_cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="modeling-dan-evaluasi-model">
<h2><strong>Modeling Dan Evaluasi Model</strong><a class="headerlink" href="#modeling-dan-evaluasi-model" title="Link to this heading">#</a></h2>
<section id="traning-model">
<h3><em>Traning Model</em><a class="headerlink" href="#traning-model" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">train_random_forest_multilabel</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">):</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span>
    <span class="p">)</span>

    <span class="c1"># Model multilabel</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">MultiOutputClassifier</span><span class="p">(</span><span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="c1"># Akurasi multilabel → hitung per label, lalu rata-rata</span>
    <span class="n">accuracies</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
        <span class="n">accuracies</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>

    <span class="n">avg_accuracy</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">accuracies</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">accuracies</span><span class="p">,</span> <span class="n">avg_accuracy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">features_df_clean</span><span class="o">.</span><span class="n">columns</span> <span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0_Absolute energy
0_Area under the curve
0_Autocorrelation
0_Average power
0_Centroid
0_ECDF Percentile Count_0
0_ECDF Percentile Count_1
0_ECDF Percentile_0
0_ECDF Percentile_1
0_ECDF_0
0_ECDF_1
0_ECDF_2
0_ECDF_3
0_ECDF_4
0_ECDF_5
0_ECDF_6
0_ECDF_7
0_ECDF_8
0_ECDF_9
0_Entropy
0_Fundamental frequency
0_Histogram mode
0_Human range energy
0_Interquartile range
0_Kurtosis
0_LPCC_0
0_LPCC_1
0_LPCC_10
0_LPCC_11
0_LPCC_2
0_LPCC_3
0_LPCC_4
0_LPCC_5
0_LPCC_6
0_LPCC_7
0_LPCC_8
0_LPCC_9
0_MFCC_0
0_MFCC_1
0_MFCC_10
0_MFCC_11
0_MFCC_2
0_MFCC_3
0_MFCC_4
0_MFCC_5
0_MFCC_6
0_MFCC_7
0_MFCC_8
0_MFCC_9
0_Max
0_Max power spectrum
0_Maximum frequency
0_Mean
0_Mean absolute deviation
0_Mean absolute diff
0_Mean diff
0_Median
0_Median absolute deviation
0_Median absolute diff
0_Median diff
0_Median frequency
0_Min
0_Negative turning points
0_Neighbourhood peaks
0_Peak to peak distance
0_Positive turning points
0_Power bandwidth
0_Root mean square
0_Signal distance
0_Skewness
0_Slope
0_Spectral centroid
0_Spectral decrease
0_Spectral distance
0_Spectral entropy
0_Spectral kurtosis
0_Spectral positive turning points
0_Spectral roll-off
0_Spectral roll-on
0_Spectral skewness
0_Spectral slope
0_Spectral spread
0_Spectral variation
0_Spectrogram mean coefficient_0.0Hz
0_Spectrogram mean coefficient_1032.26Hz
0_Spectrogram mean coefficient_1290.32Hz
0_Spectrogram mean coefficient_1548.39Hz
0_Spectrogram mean coefficient_1806.45Hz
0_Spectrogram mean coefficient_2064.52Hz
0_Spectrogram mean coefficient_2322.58Hz
0_Spectrogram mean coefficient_258.06Hz
0_Spectrogram mean coefficient_2580.65Hz
0_Spectrogram mean coefficient_2838.71Hz
0_Spectrogram mean coefficient_3096.77Hz
0_Spectrogram mean coefficient_3354.84Hz
0_Spectrogram mean coefficient_3612.9Hz
0_Spectrogram mean coefficient_3870.97Hz
0_Spectrogram mean coefficient_4129.03Hz
0_Spectrogram mean coefficient_4387.1Hz
0_Spectrogram mean coefficient_4645.16Hz
0_Spectrogram mean coefficient_4903.23Hz
0_Spectrogram mean coefficient_516.13Hz
0_Spectrogram mean coefficient_5161.29Hz
0_Spectrogram mean coefficient_5419.35Hz
0_Spectrogram mean coefficient_5677.42Hz
0_Spectrogram mean coefficient_5935.48Hz
0_Spectrogram mean coefficient_6193.55Hz
0_Spectrogram mean coefficient_6451.61Hz
0_Spectrogram mean coefficient_6709.68Hz
0_Spectrogram mean coefficient_6967.74Hz
0_Spectrogram mean coefficient_7225.81Hz
0_Spectrogram mean coefficient_7483.87Hz
0_Spectrogram mean coefficient_774.19Hz
0_Spectrogram mean coefficient_7741.94Hz
0_Spectrogram mean coefficient_8000.0Hz
0_Standard deviation
0_Sum absolute diff
0_Variance
0_Wavelet absolute mean_1000.0Hz
0_Wavelet absolute mean_1333.33Hz
0_Wavelet absolute mean_2000.0Hz
0_Wavelet absolute mean_4000.0Hz
0_Wavelet absolute mean_444.44Hz
0_Wavelet absolute mean_500.0Hz
0_Wavelet absolute mean_571.43Hz
0_Wavelet absolute mean_666.67Hz
0_Wavelet absolute mean_800.0Hz
0_Wavelet energy_1000.0Hz
0_Wavelet energy_1333.33Hz
0_Wavelet energy_2000.0Hz
0_Wavelet energy_4000.0Hz
0_Wavelet energy_444.44Hz
0_Wavelet energy_500.0Hz
0_Wavelet energy_571.43Hz
0_Wavelet energy_666.67Hz
0_Wavelet energy_800.0Hz
0_Wavelet entropy
0_Wavelet standard deviation_1000.0Hz
0_Wavelet standard deviation_1333.33Hz
0_Wavelet standard deviation_2000.0Hz
0_Wavelet standard deviation_4000.0Hz
0_Wavelet standard deviation_444.44Hz
0_Wavelet standard deviation_500.0Hz
0_Wavelet standard deviation_571.43Hz
0_Wavelet standard deviation_666.67Hz
0_Wavelet standard deviation_800.0Hz
0_Wavelet variance_1000.0Hz
0_Wavelet variance_1333.33Hz
0_Wavelet variance_2000.0Hz
0_Wavelet variance_4000.0Hz
0_Wavelet variance_444.44Hz
0_Wavelet variance_500.0Hz
0_Wavelet variance_571.43Hz
0_Wavelet variance_666.67Hz
0_Wavelet variance_800.0Hz
0_Zero crossing rate
label_buka
label_tutup
label_fikri
label_fauzan
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">optimal_n</span> <span class="o">=</span> <span class="mi">136</span>

<span class="n">X_optimal</span><span class="p">,</span> <span class="n">top_features</span> <span class="o">=</span> <span class="n">select_top_features</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">ig_score</span><span class="p">,</span> <span class="n">optimal_n</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Jumlah fitur:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_optimal</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Daftar fitur terpilih:&quot;</span><span class="p">,</span> <span class="n">top_features</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jumlah fitur: 136
Daftar fitur terpilih: Index([&#39;0_Absolute energy&#39;, &#39;0_Area under the curve&#39;, &#39;0_Autocorrelation&#39;,
       &#39;0_Average power&#39;, &#39;0_Centroid&#39;, &#39;0_ECDF Percentile Count_0&#39;,
       &#39;0_ECDF Percentile Count_1&#39;, &#39;0_ECDF Percentile_0&#39;,
       &#39;0_ECDF Percentile_1&#39;, &#39;0_ECDF_0&#39;,
       ...
       &#39;0_Wavelet absolute mean_800.0Hz&#39;, &#39;0_Wavelet energy_1000.0Hz&#39;,
       &#39;0_Wavelet energy_1333.33Hz&#39;, &#39;0_Wavelet energy_2000.0Hz&#39;,
       &#39;0_Wavelet energy_4000.0Hz&#39;, &#39;0_Wavelet energy_444.44Hz&#39;,
       &#39;0_Wavelet energy_500.0Hz&#39;, &#39;0_Wavelet energy_571.43Hz&#39;,
       &#39;0_Wavelet energy_666.67Hz&#39;, &#39;0_Wavelet energy_800.0Hz&#39;],
      dtype=&#39;object&#39;, length=136)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rf_model</span><span class="p">,</span> <span class="n">accurracy</span><span class="p">,</span> <span class="n">mean_acc</span> <span class="o">=</span> <span class="n">train_random_forest_multilabel</span><span class="p">(</span><span class="n">X_optimal</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">accurracy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;label_buka&#39;: 0.95, &#39;label_tutup&#39;: 0.95, &#39;label_fikri&#39;: 1.0, &#39;label_fauzan&#39;: 1.0}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mean_acc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.975
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="simpan-model">
<h2><strong>Simpan Model</strong><a class="headerlink" href="#simpan-model" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>

<span class="n">model_package</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;scaler&quot;</span><span class="p">:</span> <span class="n">scaler</span><span class="p">,</span>                   <span class="c1"># normalizer</span>
    <span class="s2">&quot;selected_features&quot;</span><span class="p">:</span> <span class="n">top_features</span><span class="p">,</span>  <span class="c1"># fitur terpilih hasil IG</span>
    <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">rf_model</span>                  <span class="c1"># model akhir</span>
<span class="p">}</span>

<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model_package</span><span class="p">,</span> <span class="s2">&quot;saved_models/audio-multilabel(1)/model_rf_full.pkl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;saved_models/audio-multilabel(1)/model_rf_full.pkl&#39;]
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="project-timeseries-audio-multilabel.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><em><strong>Project Time Series Audio Dataset With MultiLabel</strong></em></p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#membaca-dataset"><strong>Membaca Dataset</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ekstraksi-fitur"><strong>Ekstraksi Fitur</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seleksi-fitur-menggunakan-penilaian-score-dari-information-gain"><strong>Seleksi Fitur Menggunakan Penilaian Score dari Information Gain</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisasi-score-fitur-information-gain"><em>Visualisasi Score Fitur Information Gain</em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#show-score-valuation-with-reduce-feature"><em>Show Score Valuation with Reduce Feature</em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#memilih-jumlah-fitur-optimal"><em>Memilih Jumlah Fitur Optimal</em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#melakukan-normalisai"><em>Melakukan Normalisai</em></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling-dan-evaluasi-model"><strong>Modeling Dan Evaluasi Model</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#traning-model"><em>Traning Model</em></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simpan-model"><strong>Simpan Model</strong></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Alif Fitrah
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>